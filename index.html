<!DOCTYPE html>
<html>
<head>
    <title>Diary Emotion Detector</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

<div class="container">
    <h1>Diary Emotion Detector</h1>
    <p>Write your diary entry below and click Analyze.</p>

    <textarea id="diaryText" placeholder="Type your diary entry here..."></textarea>

    <button onclick="analyzeEmotion()">Analyze Emotion</button>

    <div id="result">Predicted Emotion: </div>

    <div id = "metrics">
    Metrics: 
    <p id = "valence">Valence: </p>
    <p id = "arousal">Arousal: </p>    
    <p id = "similarity">Similarity: </p>
    </div>
</div>

<script>
async function analyzeEmotion() {
    const diaryText = document.getElementById("diaryText").value;

    const response = await fetch("http://127.0.0.1:8000/analyze", {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify({
            "text": diaryText
        })
    })

    const data = await response.json();

    console.log(data)

    document.getElementById("result").innerText = "Predicted Emotion: " + data.emotion_label;
    document.getElementById("valence").innerText = "Valence: " + round(data.valence * 100, -2) + "%";
    document.getElementById("arousal").innerText = "Arousal: " + round(data.arousal * 100, -2) + "%";
    document.getElementById("similarity").innerText = "Similarity: " + round(data.similarity * 100, -2) + "%";
}

function round(number, precision){
    rounding = Math.round(number / Math.pow(10, precision)) * Math.pow(10, precision)

    if(rounding <= -10){
        return String(rounding).slice(0, 6)
    }else if(rounding < 0){
        return String(rounding).slice(0, 5)
    }else if(rounding < 10){
        return String(rounding).slice(0, 4)
    }else{
        return String(rounding).slice(0, 5)
    }
}
</script>

</body>
</html>
